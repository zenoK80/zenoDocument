---
title: "ìºì‹œ ì“°ê¸° ì •ì±…"
description: "ìºì‹œ ë°ì´í„° ë³€ê²½ ì‹œ ë©”ì¸ ë©”ëª¨ë¦¬ ê°±ì‹  ë°©ë²•ì¸ Write-Throughì™€ Write-Back ì •ì±…ì„ ìƒì„¸íˆ í•™ìŠµí•˜ê³  ì„±ëŠ¥ì„ ë¹„êµ ë¶„ì„í•©ë‹ˆë‹¤."
slug: "cache-write-policies"
sidebar_position: 5
---

# ìºì‹œ ì“°ê¸° ì •ì±…

## ì“°ê¸° ì •ì±…ì´ í•„ìš”í•œ ì´ìœ 

ìºì‹œëŠ” ë©”ì¸ ë©”ëª¨ë¦¬ì˜ **ë³µì‚¬ë³¸**ì„ ì €ì¥í•©ë‹ˆë‹¤. CPUê°€ ìºì‹œì˜ ë°ì´í„°ë¥¼ **ë³€ê²½**í•˜ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”?

### ë¬¸ì œ ìƒí™©

```
ì´ˆê¸° ìƒíƒœ:
ìºì‹œ:       [A = 100]  â† CPUê°€ ì½ìŒ
ë©”ì¸ ë©”ëª¨ë¦¬: [A = 100]
// ì¼ì¹˜ âœ…

CPUê°€ Aë¥¼ 200ìœ¼ë¡œ ë³€ê²½:
ìºì‹œ:       [A = 200]  â† ë³€ê²½ë¨!
ë©”ì¸ ë©”ëª¨ë¦¬: [A = 100]  â† ì•„ì§ ëª¨ë¦„
// ë¶ˆì¼ì¹˜ ë°œìƒ! ğŸš¨
```

**ë¬¸ì œì :**

```c
// Thread 1 (CPU with cache)
A = 200;  // ìºì‹œë§Œ ë³€ê²½

// Thread 2 (ë‹¤ë¥¸ CPU or I/O device)
int value = readFromMemory(A);
printf("%d", value);  // 100 ì¶œë ¥! (ì˜ëª»ëœ ê°’)
```

ì´ **ë°ì´í„° ë¶ˆì¼ì¹˜(Data Inconsistency)** ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê²ƒì´ **ì“°ê¸° ì •ì±…(Write Policy)**ì…ë‹ˆë‹¤.

## ë‘ ê°€ì§€ ì£¼ìš” ì •ì±…

ìºì‹œ ì“°ê¸° ì •ì±…ì€ í¬ê²Œ ë‘ ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤:

1. **Write-Through (ì¦‰ì‹œ ì“°ê¸°)**
2. **Write-Back (ë‚˜ì¤‘ ì“°ê¸°, Copy-Back)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì“°ê¸° ì •ì±…      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Write- â”‚ Write- â”‚
â”‚ Throughâ”‚  Back  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Write-Through (ì¦‰ì‹œ ì“°ê¸°)

### ê°œë…

**Write-Through**ëŠ” ìºì‹œ ë°ì´í„°ê°€ ë³€ê²½ë˜ë©´ **ì¦‰ì‹œ** ë©”ì¸ ë©”ëª¨ë¦¬ì—ë„ ë°˜ì˜í•˜ëŠ” ì •ì±…ì…ë‹ˆë‹¤.

```
CPU â†’ ìºì‹œ ì“°ê¸°
  â†“ (ì¦‰ì‹œ)
  â†’ ë©”ì¸ ë©”ëª¨ë¦¬ ì“°ê¸°

ìºì‹œì™€ ë©”ëª¨ë¦¬ê°€ í•­ìƒ ì¼ì¹˜!
```

### ë™ì‘ ê³¼ì •

```javascript
// Write-Through ì˜ì‚¬ ì½”ë“œ
function writeThroughWrite(address, data) {
    // 1ë‹¨ê³„: ìºì‹œì— ì“°ê¸°
    cache.write(address, data);
    console.log(`ìºì‹œ ì—…ë°ì´íŠ¸: ${address} = ${data}`);
    
    // 2ë‹¨ê³„: ì¦‰ì‹œ ë©”ì¸ ë©”ëª¨ë¦¬ì—ë„ ì“°ê¸° âš¡
    mainMemory.write(address, data);
    console.log(`ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸: ${address} = ${data}`);
    
    // ì™„ë£Œ!
}
```

### ìƒì„¸ ì˜ˆì œ

**ì‹œë‚˜ë¦¬ì˜¤: ë³€ìˆ˜ Aë¥¼ 100ì—ì„œ 200ìœ¼ë¡œ ë³€ê²½**

```
ì‹œê°„: 0ns   - CPUê°€ A = 200 ëª…ë ¹ ì‹¤í–‰
      1ns   - ìºì‹œ ë¼ì¸ ì°¾ê¸°
      2ns   - ìºì‹œì— ì“°ê¸° ì‹œì‘
      5ns   - ìºì‹œ ì“°ê¸° ì™„ë£Œ
      6ns   - ë©”ì¸ ë©”ëª¨ë¦¬ì— ì“°ê¸° ì‹œì‘ (ì¦‰ì‹œ!)
      ...   - ë²„ìŠ¤ í†µê³¼, ë©”ëª¨ë¦¬ ì»¨íŠ¸ë¡¤ëŸ¬ ì²˜ë¦¬
      56ns  - ë©”ì¸ ë©”ëª¨ë¦¬ ì“°ê¸° ì™„ë£Œ
      57ns  - ì „ì²´ ì™„ë£Œ

ì´ ì†Œìš” ì‹œê°„: ì•½ 57ns
```

**ë©”ëª¨ë¦¬ ìƒíƒœ ë³€í™”:**

```
0ns:
ìºì‹œ:       [A = 100]
ë©”ì¸ ë©”ëª¨ë¦¬: [A = 100]

5ns:
ìºì‹œ:       [A = 200]  â† ë³€ê²½ë¨
ë©”ì¸ ë©”ëª¨ë¦¬: [A = 100]  â† ì•„ì§ ì´ì „ ê°’

56ns:
ìºì‹œ:       [A = 200]
ë©”ì¸ ë©”ëª¨ë¦¬: [A = 200]  â† ì¼ì¹˜!
```

### ì½”ë“œ êµ¬í˜„

```c
#include <stdio.h>
#include <stdbool.h>

#define CACHE_SIZE 4

typedef struct {
    int address;
    int data;
    bool valid;
} CacheLine;

CacheLine cache[CACHE_SIZE];
int memory[1000];  // ë©”ì¸ ë©”ëª¨ë¦¬ ì‹œë®¬ë ˆì´ì…˜

// Write-Through ì •ì±…ìœ¼ë¡œ ì“°ê¸°
void writeThrough(int address, int data) {
    printf("Write-Through: addr=%d, data=%d\n", address, data);
    
    // 1. ìºì‹œì—ì„œ ë¼ì¸ ì°¾ê¸° ë˜ëŠ” í• ë‹¹
    int cacheIndex = address % CACHE_SIZE;
    
    // 2. ìºì‹œì— ì“°ê¸°
    cache[cacheIndex].address = address;
    cache[cacheIndex].data = data;
    cache[cacheIndex].valid = true;
    printf("  ìºì‹œ ì—…ë°ì´íŠ¸: index=%d\n", cacheIndex);
    
    // 3. ì¦‰ì‹œ ë©”ì¸ ë©”ëª¨ë¦¬ì—ë„ ì“°ê¸°
    memory[address] = data;
    printf("  ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸: addr=%d\n", address);
    
    // í•­ìƒ ì¼ì¹˜!
}

// ì½ê¸°
int read(int address) {
    int cacheIndex = address % CACHE_SIZE;
    
    // ìºì‹œ íˆíŠ¸
    if (cache[cacheIndex].valid && 
        cache[cacheIndex].address == address) {
        printf("ìºì‹œ íˆíŠ¸: %d\n", cache[cacheIndex].data);
        return cache[cacheIndex].data;
    }
    
    // ìºì‹œ ë¯¸ìŠ¤ - ë©”ëª¨ë¦¬ì—ì„œ ì½ê¸°
    printf("ìºì‹œ ë¯¸ìŠ¤: ë©”ëª¨ë¦¬ì—ì„œ ë¡œë“œ\n");
    int data = memory[address];
    
    // ìºì‹œì— ì €ì¥
    cache[cacheIndex].address = address;
    cache[cacheIndex].data = data;
    cache[cacheIndex].valid = true;
    
    return data;
}
```

### ì‚¬ìš© ì˜ˆì œ

```c
int main() {
    // ì´ˆê¸°í™”
    for (int i = 0; i < 1000; i++) {
        memory[i] = 0;
    }
    
    // Write-Through ë™ì‘
    writeThrough(100, 42);
    // ì¶œë ¥:
    // Write-Through: addr=100, data=42
    //   ìºì‹œ ì—…ë°ì´íŠ¸: index=0
    //   ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸: addr=100
    
    printf("\nìºì‹œ ìƒíƒœ: %d\n", cache[0].data);      // 42
    printf("ë©”ëª¨ë¦¬ ìƒíƒœ: %d\n", memory[100]);        // 42
    // ë‘˜ ë‹¤ 42ë¡œ ì¼ì¹˜!
    
    // ì—¬ëŸ¬ ë²ˆ ì“°ê¸°
    writeThrough(100, 99);   // ì¦‰ì‹œ ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸
    writeThrough(100, 77);   // ë˜ ì¦‰ì‹œ ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸
    
    return 0;
}
```

### Write-Throughì˜ ì¥ì 

#### 1. ë°ì´í„° ì¼ê´€ì„± ë³´ì¥

```
í•­ìƒ ìºì‹œ = ë©”ëª¨ë¦¬

ë‹¤ë¥¸ ì¥ì¹˜(I/O, ë‹¤ë¥¸ CPU)ê°€ ë©”ëª¨ë¦¬ ì½ì–´ë„
ì •í™•í•œ ìµœì‹  ê°’ íšë“ âœ…
```

#### 2. êµ¬í˜„ ë‹¨ìˆœ

```c
void write(addr, data) {
    cache[addr] = data;      // 1. ìºì‹œ ì—…ë°ì´íŠ¸
    memory[addr] = data;     // 2. ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸
}
// ê°„ë‹¨ëª…ë£Œ!
```

#### 3. ì •ì „ ì•ˆì „

```
ì •ì „ ë°œìƒ ì‹œ:
ë©”ëª¨ë¦¬ì— í•­ìƒ ìµœì‹  ë°ì´í„° ìˆìŒ
â†’ ë°ì´í„° ì†ì‹¤ ì—†ìŒ âœ…
```

**ì‹œë‚˜ë¦¬ì˜¤:**

```
10:00:00 - A = 100 (ìºì‹œ, ë©”ëª¨ë¦¬ ëª¨ë‘ ì—…ë°ì´íŠ¸)
10:00:01 - A = 200 (ìºì‹œ, ë©”ëª¨ë¦¬ ëª¨ë‘ ì—…ë°ì´íŠ¸)
10:00:02 - âš¡ ì •ì „!
10:01:00 - ì‹œìŠ¤í…œ ì¬ì‹œì‘
           ë©”ëª¨ë¦¬: A = 200 (ì†ì‹¤ ì—†ìŒ!)
```

### Write-Throughì˜ ë‹¨ì 

#### 1. ì“°ê¸° ì„±ëŠ¥ ì €í•˜

```javascript
// ë§¤ë²ˆ ëŠë¦° ë©”ëª¨ë¦¬ ì ‘ê·¼ í•„ìš”
ì“°ê¸° ì‹œê°„ = ìºì‹œ ì“°ê¸° + ë©”ëª¨ë¦¬ ì“°ê¸°
         = 5ns + 50ns
         = 55ns (ëŠë¦¼!)

// ìºì‹œë§Œ ì¼ë‹¤ë©´ 5nsë¡œ ëë‚¬ì„ ê²ƒì„...
```

**ì„±ëŠ¥ ë¹„êµ:**

```c
// Write-Through
for (int i = 0; i < 1000; i++) {
    array[i] = i;  // ê° ì“°ê¸°ë§ˆë‹¤ 55ns
}
// ì´ ì‹œê°„: 1000 Ã— 55ns = 55,000ns = 55Î¼s

// ìºì‹œë§Œ ì‚¬ìš©
for (int i = 0; i < 1000; i++) {
    array[i] = i;  // ê° ì“°ê¸°ë§ˆë‹¤ 5ns
}
// ì´ ì‹œê°„: 1000 Ã— 5ns = 5,000ns = 5Î¼s

// 11ë°° ì°¨ì´! ğŸ˜±
```

#### 2. ë²„ìŠ¤ íŠ¸ë˜í”½ ì¦ê°€

```
CPU â†’ ìºì‹œ: ë‚´ë¶€ ë²„ìŠ¤ (ë¹ ë¦„)
CPU â†’ ë©”ëª¨ë¦¬: ì‹œìŠ¤í…œ ë²„ìŠ¤ (ê³µìœ  ìì›)

ë§¤ë²ˆ ë©”ëª¨ë¦¬ ì“°ê¸° = ë²„ìŠ¤ ì‚¬ìš© ì¦ê°€
â†’ ë‹¤ë¥¸ ì¥ì¹˜ë“¤ì´ ë²„ìŠ¤ ì‚¬ìš© ëª»í•¨
â†’ ì „ì²´ ì‹œìŠ¤í…œ ì„±ëŠ¥ ì €í•˜
```

### Write Bufferë¥¼ ì‚¬ìš©í•œ ê°œì„ 

**ë¬¸ì œì :**
```
CPUê°€ ë©”ëª¨ë¦¬ ì“°ê¸° ì™„ë£Œë¥¼ ê¸°ë‹¤ë ¤ì•¼ í•¨
â†’ 50ns ë™ì•ˆ ì•„ë¬´ê²ƒë„ ëª»í•¨
```

**í•´ê²°ì±…: ì“°ê¸° ë²„í¼(Write Buffer)**

```
CPU â†’ ìºì‹œ (5ns)
     â†“
  ì“°ê¸° ë²„í¼ì— ì €ì¥ (1ns)
     â†“
CPUëŠ” ë‹¤ìŒ ì‘ì—… ì§„í–‰! âœ…
     
ë°±ê·¸ë¼ìš´ë“œ:
  ì“°ê¸° ë²„í¼ â†’ ë©”ëª¨ë¦¬ (50ns)
```

**ì½”ë“œë¡œ ì´í•´:**

```javascript
// ì“°ê¸° ë²„í¼ ì‚¬ìš©
class WriteBuffer {
    constructor() {
        this.queue = [];
    }
    
    write(address, data) {
        // 1. ìºì‹œì— ì“°ê¸° (ë¹ ë¦„)
        cache.write(address, data);
        
        // 2. ì“°ê¸° ë²„í¼ì— ì¶”ê°€ (ë¹ ë¦„)
        this.queue.push({address, data});
        
        // 3. CPUëŠ” ì¦‰ì‹œ ë°˜í™˜! (ì—¬ê¸°ê¹Œì§€ 6ns)
        // (ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë²„í¼ê°€ ë©”ëª¨ë¦¬ì— ì”€)
    }
    
    async flush() {
        // ë°±ê·¸ë¼ìš´ë“œ ì‘ì—…
        while (this.queue.length > 0) {
            const {address, data} = this.queue.shift();
            await mainMemory.write(address, data);  // 50ns
        }
    }
}
```

**íš¨ê³¼:**

```
ì“°ê¸° ë²„í¼ ì—†ì´:
CPU ëŒ€ê¸° ì‹œê°„ = 55ns

ì“°ê¸° ë²„í¼ ì‚¬ìš©:
CPU ëŒ€ê¸° ì‹œê°„ = 6ns (ì•½ 9ë°° ë¹ ë¦„!)
```

## Write-Back (ë‚˜ì¤‘ ì“°ê¸°)

### ê°œë…

**Write-Back**ì€ ìºì‹œ ë°ì´í„°ê°€ ë³€ê²½ë˜ì–´ë„ **ì¦‰ì‹œ ë©”ëª¨ë¦¬ì— ì“°ì§€ ì•Šê³ **, í•´ë‹¹ ë¸”ë¡ì´ **êµì²´ë  ë•Œ** ë©”ëª¨ë¦¬ì— ë°˜ì˜í•˜ëŠ” ì •ì±…ì…ë‹ˆë‹¤.

```
CPU â†’ ìºì‹œ ì“°ê¸°
     â†“
  Dirty ë¹„íŠ¸ ì„¤ì • ğŸš©
     â†“
CPUëŠ” ì¦‰ì‹œ ë°˜í™˜ âœ…

... ë‚˜ì¤‘ì— ë¸”ë¡ êµì²´ ì‹œ ...
     â†“
  ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸
```

### Dirty Bit (ìˆ˜ì • ë¹„íŠ¸)

**Dirty Bit**ëŠ” ìºì‹œ ë¸”ë¡ì´ ìˆ˜ì •ë˜ì—ˆëŠ”ì§€ ì¶”ì í•˜ëŠ” 1ë¹„íŠ¸ í”Œë˜ê·¸ì…ë‹ˆë‹¤.

```
Dirty Bit = 0: ê¹¨ë—í•¨ (Clean)
  - ìºì‹œì™€ ë©”ëª¨ë¦¬ê°€ ì¼ì¹˜
  - êµì²´ ì‹œ ê·¸ëƒ¥ ë²„ë ¤ë„ ë¨

Dirty Bit = 1: ë”ëŸ¬ì›€ (Dirty)
  - ìºì‹œê°€ ìˆ˜ì •ë¨
  - êµì²´ ì‹œ ë©”ëª¨ë¦¬ì— ì¨ì•¼ í•¨!
```

### ë™ì‘ ê³¼ì •

```javascript
// Write-Back ì˜ì‚¬ ì½”ë“œ
function writeBackWrite(address, data) {
    // 1. ìºì‹œì— ì“°ê¸° (ë¹ ë¦„!)
    cache.write(address, data);
    
    // 2. Dirty ë¹„íŠ¸ ì„¤ì •
    cache.setDirtyBit(address, 1);  // ğŸš© "ë‚˜ì¤‘ì— ì—…ë°ì´íŠ¸ í•„ìš”"
    
    // 3. ì¦‰ì‹œ ë°˜í™˜! (ë©”ëª¨ë¦¬ ì•ˆ ê¸°ë‹¤ë¦¼)
    return;
    
    // ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸ëŠ” ë‚˜ì¤‘ì—...
}

function evictBlock(cacheIndex) {
    const block = cache.lines[cacheIndex];
    
    // Dirty ë¹„íŠ¸ í™•ì¸
    if (block.dirtyBit === 1) {
        // ìˆ˜ì •ë˜ì—ˆìœ¼ë©´ ë©”ëª¨ë¦¬ì— ì¨ì•¼ í•¨
        console.log("Dirty block! ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸ ì¤‘...");
        mainMemory.write(block.address, block.data);
    }
    
    // ë¸”ë¡ ì œê±°
    cache.remove(cacheIndex);
}
```

### ìƒì„¸ ì˜ˆì œ

**ì‹œë‚˜ë¦¬ì˜¤: ê°™ì€ ë³€ìˆ˜ë¥¼ ì—¬ëŸ¬ ë²ˆ ìˆ˜ì •**

```c
// Write-Back ì •ì±…
A = 100;  // ìºì‹œì—ë§Œ ì“°ê¸°, Dirty = 1
A = 200;  // ìºì‹œì—ë§Œ ì“°ê¸°, Dirty = 1
A = 300;  // ìºì‹œì—ë§Œ ì“°ê¸°, Dirty = 1

// ë¸”ë¡ êµì²´ ë°œìƒ
// â†’ ì´ë•Œ A = 300ì„ ë©”ëª¨ë¦¬ì— í•œ ë²ˆë§Œ ì”€!
```

**íƒ€ì„ë¼ì¸:**

```
0ns:   A = 100 ì“°ê¸° ì‹œì‘
5ns:   ìºì‹œ ì—…ë°ì´íŠ¸, Dirty=1, ì™„ë£Œ! âœ…
       (ë©”ëª¨ë¦¬ëŠ” ì•„ì§ ì´ì „ ê°’)

10ns:  A = 200 ì“°ê¸° ì‹œì‘
15ns:  ìºì‹œ ì—…ë°ì´íŠ¸, Dirty=1, ì™„ë£Œ! âœ…

20ns:  A = 300 ì“°ê¸° ì‹œì‘
25ns:  ìºì‹œ ì—…ë°ì´íŠ¸, Dirty=1, ì™„ë£Œ! âœ…

... ì‹œê°„ ê²½ê³¼ ...

1000ns: A ë¸”ë¡ êµì²´ í•„ìš”
1001ns: Dirty ë¹„íŠ¸ í™•ì¸ â†’ 1 (ë”ëŸ¬ì›€)
1002ns: ë©”ëª¨ë¦¬ì— A = 300 ì“°ê¸° ì‹œì‘
1052ns: ë©”ëª¨ë¦¬ ì“°ê¸° ì™„ë£Œ

// 3ë²ˆ ì“°ê¸°í–ˆì§€ë§Œ ë©”ëª¨ë¦¬ëŠ” í•œ ë²ˆë§Œ ì—…ë°ì´íŠ¸!
```

### ì½”ë“œ êµ¬í˜„

```c
#include <stdio.h>
#include <stdbool.h>

#define CACHE_SIZE 4

typedef struct {
    int address;
    int data;
    bool valid;
    bool dirty;  // Dirty ë¹„íŠ¸!
} CacheLine;

CacheLine cache[CACHE_SIZE];
int memory[1000];

// Write-Back ì •ì±…ìœ¼ë¡œ ì“°ê¸°
void writeBack(int address, int data) {
    printf("Write-Back: addr=%d, data=%d\n", address, data);
    
    int cacheIndex = address % CACHE_SIZE;
    
    // ìºì‹œì— ì´ë¯¸ ìˆëŠ”ì§€ í™•ì¸
    if (cache[cacheIndex].valid && 
        cache[cacheIndex].address == address) {
        // ìºì‹œ íˆíŠ¸ - ìºì‹œë§Œ ì—…ë°ì´íŠ¸
        cache[cacheIndex].data = data;
        cache[cacheIndex].dirty = true;  // Dirty ì„¤ì •
        printf("  ìºì‹œ ì—…ë°ì´íŠ¸ (Dirty=1)\n");
        return;  // ì¦‰ì‹œ ë°˜í™˜!
    }
    
    // ìºì‹œ ë¯¸ìŠ¤ - ë¸”ë¡ êµì²´ í•„ìš”
    if (cache[cacheIndex].valid) {
        // ê¸°ì¡´ ë¸”ë¡ ìˆìŒ
        evictBlock(cacheIndex);
    }
    
    // ìƒˆ ë¸”ë¡ ë¡œë“œ
    cache[cacheIndex].address = address;
    cache[cacheIndex].data = data;
    cache[cacheIndex].valid = true;
    cache[cacheIndex].dirty = true;  // ìˆ˜ì •í–ˆìœ¼ë¯€ë¡œ Dirty
    printf("  ìƒˆ ë¸”ë¡ ë¡œë“œ (Dirty=1)\n");
}

// ë¸”ë¡ êµì²´
void evictBlock(int index) {
    if (!cache[index].valid) return;
    
    printf("ë¸”ë¡ êµì²´: index=%d\n", index);
    
    // Dirty ë¹„íŠ¸ í™•ì¸
    if (cache[index].dirty) {
        printf("  Dirty! ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸: addr=%d, data=%d\n",
               cache[index].address, cache[index].data);
        memory[cache[index].address] = cache[index].data;
    } else {
        printf("  Clean! ê·¸ëƒ¥ ì œê±°\n");
    }
    
    cache[index].valid = false;
    cache[index].dirty = false;
}

// ì½ê¸°
int readData(int address) {
    int cacheIndex = address % CACHE_SIZE;
    
    if (cache[cacheIndex].valid && 
        cache[cacheIndex].address == address) {
        return cache[cacheIndex].data;
    }
    
    // ë¯¸ìŠ¤ - ë©”ëª¨ë¦¬ì—ì„œ ë¡œë“œ
    if (cache[cacheIndex].valid) {
        evictBlock(cacheIndex);
    }
    
    int data = memory[address];
    cache[cacheIndex].address = address;
    cache[cacheIndex].data = data;
    cache[cacheIndex].valid = true;
    cache[cacheIndex].dirty = false;  // ì½ê¸°ë§Œ í–ˆìœ¼ë¯€ë¡œ Clean
    
    return data;
}
```

### ì‚¬ìš© ì˜ˆì œ

```c
int main() {
    // ì´ˆê¸°í™”
    for (int i = 0; i < 1000; i++) {
        memory[i] = 0;
    }
    
    // Write-Back ë™ì‘
    writeBack(100, 42);
    // ì¶œë ¥:
    // Write-Back: addr=100, data=42
    //   ìƒˆ ë¸”ë¡ ë¡œë“œ (Dirty=1)
    
    printf("ìºì‹œ: %d, Dirty: %d\n", 
           cache[0].data, cache[0].dirty);  // 42, 1
    printf("ë©”ëª¨ë¦¬: %d\n", memory[100]);    // 0 (ì•„ì§ ì•ˆ ì”€!)
    
    // ê°™ì€ ì£¼ì†Œ ì—¬ëŸ¬ ë²ˆ ì“°ê¸°
    writeBack(100, 99);
    writeBack(100, 77);
    // ëª¨ë‘ ìºì‹œë§Œ ì—…ë°ì´íŠ¸!
    
    printf("ë©”ëª¨ë¦¬: %d\n", memory[100]);    // ì—¬ì „íˆ 0
    
    // ë¸”ë¡ êµì²´ ê°•ì œ
    evictBlock(0);
    // ì¶œë ¥:
    // ë¸”ë¡ êµì²´: index=0
    //   Dirty! ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸: addr=100, data=77
    
    printf("ë©”ëª¨ë¦¬: %d\n", memory[100]);    // ì´ì œ 77!
    
    return 0;
}
```

### Write-Backì˜ ì¥ì 

#### 1. ì“°ê¸° ì„±ëŠ¥ í–¥ìƒ

```javascript
// ìºì‹œì—ë§Œ ì“°ê¸°
ì“°ê¸° ì‹œê°„ = 5ns (ë§¤ìš° ë¹ ë¦„!)

// vs Write-Through
ì“°ê¸° ì‹œê°„ = 55ns

// 11ë°° ë¹ ë¦„! ğŸš€
```

#### 2. ë²„ìŠ¤ íŠ¸ë˜í”½ ê°ì†Œ

```
ê°™ì€ ë³€ìˆ˜ 100ë²ˆ ì“°ê¸°:

Write-Through:
  ë²„ìŠ¤ ì‚¬ìš©: 100ë²ˆ

Write-Back:
  ë²„ìŠ¤ ì‚¬ìš©: 1ë²ˆ (êµì²´ ì‹œì—ë§Œ)

// 99% ë²„ìŠ¤ íŠ¸ë˜í”½ ê°ì†Œ!
```

#### 3. ë©”ëª¨ë¦¬ ì“°ê¸° íšŸìˆ˜ ìµœì†Œí™”

```c
// ë£¨í”„ ë³€ìˆ˜
for (int i = 0; i < 1000; i++) {
    // ië¥¼ 1000ë²ˆ ì—…ë°ì´íŠ¸
}

Write-Through:
  ë©”ëª¨ë¦¬ ì“°ê¸°: 1000ë²ˆ

Write-Back:
  ë©”ëª¨ë¦¬ ì“°ê¸°: 1ë²ˆ (ë£¨í”„ ì¢…ë£Œ í›„)
```

### Write-Backì˜ ë‹¨ì 

#### 1. êµ¬í˜„ ë³µì¡ë„ ì¦ê°€

```c
// Dirty ë¹„íŠ¸ í•„ìš”
typedef struct {
    int data;
    bool dirty;  // ì¶”ê°€ ë¹„íŠ¸
} CacheLine;

// êµì²´ ì‹œ Dirty í™•ì¸ í•„ìš”
if (cache[i].dirty) {
    writeToMemory();  // ì¶”ê°€ ë¡œì§
}
```

#### 2. êµì²´ ì‹œê°„ ì¦ê°€

```
Write-Through êµì²´:
  ë¸”ë¡ ì œê±°: ì¦‰ì‹œ (ë©”ëª¨ë¦¬ ì´ë¯¸ ì¼ì¹˜)

Write-Back êµì²´:
  1. Dirty í™•ì¸
  2. Dirtyë©´ ë©”ëª¨ë¦¬ ì“°ê¸° (50ns)
  3. ë¸”ë¡ ì œê±°

// Dirty ë¸”ë¡ êµì²´ ì‹œ 50ns ì¶”ê°€ ì†Œìš”
```

#### 3. ì •ì „ ìœ„í—˜

```
10:00:00 - A = 200 (ìºì‹œì—ë§Œ ì”€, Dirty=1)
10:00:01 - âš¡ ì •ì „!
10:01:00 - ì‹œìŠ¤í…œ ì¬ì‹œì‘
           ë©”ëª¨ë¦¬: A = ??? (ì´ì „ ê°’)
           ìºì‹œ: ì‚¬ë¼ì§
           
â†’ ë°ì´í„° ì†ì‹¤! ğŸ˜±
```

#### 4. ë°ì´í„° ì¼ê´€ì„± ë¬¸ì œ

```c
// CPU 1
cache1[A] = 200;  // Dirty=1, ë©”ëª¨ë¦¬ëŠ” ì•„ì§ 100

// CPU 2 or I/O Device
int value = memory[A];  // 100 ì½ìŒ (ì˜ëª»ëœ ê°’!)

// ë¶ˆì¼ì¹˜ ë°œìƒ!
```

**í•´ê²°ì±…: ìºì‹œ ì¼ê´€ì„± í”„ë¡œí† ì½œ**
- MESI (Modified, Exclusive, Shared, Invalid)
- MOESI
- (ì´ ë‚´ìš©ì€ ê³ ê¸‰ ì£¼ì œë¡œ, ë³„ë„ ë¬¸ì„œì—ì„œ ë‹¤ë£¸)

## Write-Through vs Write-Back ì„±ëŠ¥ ë¹„êµ

### ì‹¤í—˜ ì¡°ê±´

```
ìºì‹œ ì ‘ê·¼ ì‹œê°„: 5ns
ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„: 50ns
ì „ì²´ ì ‘ê·¼ ì¤‘ ì½ê¸°: 70%, ì“°ê¸°: 30%
ìºì‹œ íˆíŠ¸ìœ¨: 90%
Write-Back: ë¯¸ìŠ¤ ì‹œ 20%ëŠ” Dirty
```

### ê³„ì‚° ê³¼ì •

#### Write-Through

**ì½ê¸° í‰ê·  ì‹œê°„:**
```
ì½ê¸° ì‹œê°„ = Tc Ã— h + Tm Ã— (1-h)
         = 5 Ã— 0.9 + 50 Ã— 0.1
         = 4.5 + 5
         = 9.5ns
```

**ì“°ê¸° í‰ê·  ì‹œê°„:**
```
// í•­ìƒ ë©”ëª¨ë¦¬ì— ì¨ì•¼ í•¨
ì“°ê¸° ì‹œê°„ = Tm = 50ns
```

**ì „ì²´ í‰ê·  ì‹œê°„:**
```
ì „ì²´ = ì½ê¸°ë¹„ìœ¨ Ã— ì½ê¸°ì‹œê°„ + ì“°ê¸°ë¹„ìœ¨ Ã— ì“°ê¸°ì‹œê°„
     = 0.7 Ã— 9.5 + 0.3 Ã— 50
     = 6.65 + 15
     = 21.65ns
```

#### Write-Back

**ì½ê¸° í‰ê·  ì‹œê°„:**
```
// Write-Throughì™€ ë™ì¼
ì½ê¸° ì‹œê°„ = 9.5ns
```

**ì“°ê¸° í‰ê·  ì‹œê°„:**
```
// íˆíŠ¸ ì‹œ: ìºì‹œë§Œ
ì“°ê¸° íˆíŠ¸ = 5ns

// ë¯¸ìŠ¤ ì‹œ: ë©”ëª¨ë¦¬ ì½ê¸° + (20%ëŠ” Dirty ì“°ê¸°)
ì“°ê¸° ë¯¸ìŠ¤ = Tm + 0.2 Ã— Tm
         = 50 + 10
         = 60ns

// í‰ê· 
ì“°ê¸° ì‹œê°„ = h Ã— 5 + (1-h) Ã— 60
         = 0.9 Ã— 5 + 0.1 Ã— 60
         = 4.5 + 6
         = 10.5ns
```

**ì „ì²´ í‰ê·  ì‹œê°„:**
```
ì „ì²´ = 0.7 Ã— 9.5 + 0.3 Ã— 10.5
     = 6.65 + 3.15
     = 9.8ns
```

### ê²°ê³¼ ë¹„êµ

```
Write-Through: 21.65ns
Write-Back:     9.8ns

ì„±ëŠ¥ í–¥ìƒ: 21.65 / 9.8 â‰ˆ 2.2ë°° ë¹ ë¦„! ğŸš€
```

**ê·¸ë˜í”„:**

```
í‰ê·  ì ‘ê·¼ ì‹œê°„ (ns)
  â†‘
25â”¤
  â”‚  â—â”€â”€â”€â”€â”€ Write-Through (21.65ns)
20â”¤  â”‚
  â”‚  â”‚
15â”¤  â”‚
  â”‚  â”‚
10â”¤  â”‚
  â”‚  â””â”€â”€â”€â”€â”€ Write-Back (9.8ns)
 5â”¤         â—
  â”‚
 0â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
```

## ì •ì±… ì„ íƒ ê°€ì´ë“œ

### Write-Through ì‚¬ìš©

```
âœ… ì í•©í•œ ê²½ìš°:
- ë°ì´í„° ì¼ê´€ì„±ì´ ë§¤ìš° ì¤‘ìš”
- ì •ì „ ìœ„í—˜ì´ ìˆëŠ” í™˜ê²½
- ë©€í‹°í”„ë¡œì„¸ì„œ ì‹œìŠ¤í…œ (ì¼ê´€ì„± ìœ ì§€)
- I/O ì¥ì¹˜ì™€ ìì£¼ í†µì‹ 

ì˜ˆ: ê¸ˆìœµ ì‹œìŠ¤í…œ, ë°ì´í„°ë² ì´ìŠ¤, ì„ë² ë””ë“œ ì‹œìŠ¤í…œ
```

### Write-Back ì‚¬ìš©

```
âœ… ì í•©í•œ ê²½ìš°:
- ì“°ê¸° ì„±ëŠ¥ì´ ì¤‘ìš”
- ê°™ì€ ë°ì´í„°ë¥¼ ë°˜ë³µ ìˆ˜ì •
- UPS ë“± ì „ì› ë³´í˜¸ ì¥ì¹˜ ìˆìŒ
- ë‹¨ì¼ í”„ë¡œì„¸ì„œ ì‹œìŠ¤í…œ

ì˜ˆ: ê³ ì„±ëŠ¥ ì»´í“¨íŒ…, ê²Œì„, ê³¼í•™ ê³„ì‚°
```

### í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼

ì‹¤ì œ ì‹œìŠ¤í…œì€ **ì¡°í•©**ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤:

```
L1 ìºì‹œ: Write-Back (ì„±ëŠ¥ ì¤‘ìš”)
L2 ìºì‹œ: Write-Back (ì„±ëŠ¥ ì¤‘ìš”)
L3 ìºì‹œ: Write-Through ë˜ëŠ” Write-Back
ë©”ëª¨ë¦¬:  ìµœì¢… ì €ì¥ì†Œ
```

## ì •ë¦¬

### í•µì‹¬ ë¹„êµ

| íŠ¹ì„± | Write-Through | Write-Back |
|------|--------------|-----------|
| **ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸** | ì¦‰ì‹œ | êµì²´ ì‹œ |
| **ì“°ê¸° ì†ë„** | ëŠë¦¼ (50ns) | ë¹ ë¦„ (5ns) |
| **êµ¬í˜„** | ê°„ë‹¨ | ë³µì¡ (Dirty ë¹„íŠ¸) |
| **ì¼ê´€ì„±** | í•­ìƒ ë³´ì¥ | ì§€ì—°ë¨ |
| **ë²„ìŠ¤ íŠ¸ë˜í”½** | ë†’ìŒ | ë‚®ìŒ |
| **ì •ì „ ì•ˆì „** | ì•ˆì „ | ìœ„í—˜ |
| **ì í•© í™˜ê²½** | ì•ˆì •ì„± ì¤‘ìš” | ì„±ëŠ¥ ì¤‘ìš” |

### ì„±ëŠ¥ ìš”ì•½

```
Write-Backì´ Write-Throughë³´ë‹¤
í‰ê·  2~3ë°° ë¹ ë¦„

í•˜ì§€ë§Œ:
- êµ¬í˜„ ë³µì¡
- ì¼ê´€ì„± ë¬¸ì œ
- ì •ì „ ìœ„í—˜

â†’ ìƒí™©ì— ë”°ë¼ ì„ íƒ!
```

### ë‹¤ìŒ ë‹¨ê³„

ë‹¤ìŒ ë¬¸ì„œì—ì„œëŠ” **ê³„ì¸µì  ìºì‹œ**ë¥¼ ë°°ì›ë‹ˆë‹¤:
- L1, L2, L3 ìºì‹œ
- ë‹¤ë‹¨ê³„ ìºì‹œì˜ ì„±ëŠ¥ ë¶„ì„
- í†µí•© ìºì‹œ vs ë¶„ë¦¬ ìºì‹œ

:::tip ì‹¤ì „ ì„ íƒ
ëŒ€ë¶€ë¶„ì˜ í˜„ëŒ€ CPU:
- L1/L2: Write-Back (ì„±ëŠ¥)
- L3: Write-Back or Write-Through
- ì“°ê¸° ë²„í¼ë¡œ ì„±ëŠ¥ ê°œì„ 
:::