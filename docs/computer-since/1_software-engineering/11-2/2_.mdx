---
title: "시퀀스와 상태 다이어그램"
description: "UML의 동작 다이어그램 (시퀀스, 상태 다이어그램)을 코드로 구현하는 방법을 학습합니다."
slug: "sequence-state-diagrams"
sidebar_position: 2
date: "2024-01-17"
---

# 시퀀스와 상태 다이어그램

## 시퀀스 다이어그램 (Sequence Diagram)

### 시퀀스 다이어그램이란?

**시퀀스 다이어그램** = 객체들 사이의 상호작용을 시간 순서대로 표현

```
설명: 사용자가 체크아웃하는 과정

1단계: User (사용자)
2단계: Order System (주문 시스템)
3단계: Database (데이터베이스)
4단계: Document (문서)

시간 순서대로 메시지 교환이 일어남
```

### 시퀀스 다이어그램의 흐름

```
시간 →

Actor        System        DB          Document
  │            │            │            │
  │──request──>│            │            │
  │            │──query────>│            │
  │            │<──result───│            │
  │            │──generate─────────────>│
  │            │<──confirm──────────────│
  │<──response─│            │            │
  │            │            │            │
```

### 코드로의 변환

```java
public class CheckoutService {
    private Database db;
    private DocumentGenerator documentGenerator;
    
    public void checkout(User user) {
        // 1. 사용자의 요청 받음
        Order order = user.getOrder();
        
        // 2. 데이터베이스에서 검증
        if (db.validateOrder(order)) {
            // 3. 문서 생성
            Document doc = documentGenerator.generate(order);
            
            // 4. 결과 반환
            System.out.println("주문 완료");
        } else {
            System.out.println("문서를 발견할 수 없습니다");
        }
    }
}
```

**코드 한 줄 한 줄 리뷰:**

```java
public class CheckoutService {
    // 다른 객체들에 대한 참조
    private Database db;           // 데이터베이스 참조
    private DocumentGenerator documentGenerator;  // 문서 생성기 참조
    
    public void checkout(User user) {
        // 이 메서드는 시퀀스의 전체 흐름을 표현
        
        Order order = user.getOrder();
        // 사용자의 주문 정보를 가져옴 (1단계)
        
        if (db.validateOrder(order)) {
            // 데이터베이스에서 주문을 검증 (2단계)
            
            Document doc = documentGenerator.generate(order);
            // 문서를 생성 (3단계)
            
            System.out.println("주문 완료");
            // 결과 반환 (4단계)
        } else {
            System.out.println("문서를 발견할 수 없습니다");
        }
    }
}
```

### 시퀀스 다이어그램의 특징

```
장점:
✅ 객체들의 상호작용이 명확함
✅ 시간 순서가 중요한 경우 유용
✅ 순차적 처리를 표현하기 좋음

사용 시기:
├─ 복잡한 프로세스 흐름 표현
├─ 여러 객체의 협력 관계 표현
└─ 호출 순서가 중요한 경우
```

---

## 상태 다이어그램 (State Diagram)

### 상태 다이어그램이란?

**상태 다이어그램** = 객체의 상태 변화를 표현

```
객체가 가질 수 있는 상태:

상태 1: "주문 대기"
    ↓ (주문 버튼 클릭)
상태 2: "결제 진행 중"
    ↓ (결제 완료)
상태 3: "배송 중"
    ↓ (배송 완료)
상태 4: "배송 완료"
```

### 상태 다이어그램의 구성요소

```
상태 (State):
└─ 객체가 가질 수 있는 상태
└─ 속성으로 저장해야 함

이벤트 (Event):
└─ 상태를 변화시키는 작업
└─ 메서드로 구현

조건 (Condition):
└─ 상태 변화의 조건
└─ if 문으로 표현

액션 (Action):
└─ 실제 수행되는 명령어
└─ 메서드 내의 구현
```

### 코드로의 변환

```java
// 상태를 상수로 정의
public class Order {
    // 상태들을 정수 상수로 표현
    public static final int PENDING = 1;      // 대기
    public static final int PROCESSING = 2;  // 처리 중
    public static final int SHIPPED = 3;     // 배송 중
    
    private int state;  // 현재 상태를 저장하는 속성
    
    // 이벤트: 주문 처리
    public void processOrder() {
        // 스위치문으로 상태에 따라 다르게 처리
        switch (state) {
            case PENDING:
                // 상태 1: 대기 상태일 때
                state = PROCESSING;  // 상태 2로 변경
                System.out.println("결제 진행 중");
                break;
            
            case PROCESSING:
                // 상태 2: 처리 중일 때
                state = SHIPPED;  // 상태 3으로 변경
                System.out.println("배송 중");
                break;
            
            case SHIPPED:
                // 상태 3: 배송 중일 때
                System.out.println("배송 완료");
                break;
            
            default:
                System.out.println("알 수 없는 상태");
        }
    }
}
```

**코드 한 줄 한 줄 리뷰:**

```java
public static final int PENDING = 1;
// public static final: 상수 선언
// int: 정수 타입
// PENDING: 상태를 나타내는 상수 이름
// 1: 상태를 구분하는 숫자값

private int state;
// private: 이 클래스 내에서만 접근 가능
// int state: 현재 상태를 저장하는 변수

switch (state) {
    // state 값에 따라 다르게 처리
    case PENDING:
        // state가 PENDING(1)일 때 실행
        state = PROCESSING;  // 상태 변경
        break;  // 스위치문 끝내기
}
```

### 상태 다이어그램의 흐름

```
시작
  │
  ├─ state = PENDING
  │
  ├─ 조건 확인: state == PENDING?
  │   ├─ YES: PROCESSING으로 변경
  │   └─ NO: 다음 조건 확인
  │
  ├─ 조건 확인: state == PROCESSING?
  │   ├─ YES: SHIPPED으로 변경
  │   └─ NO: 다음 조건 확인
  │
  └─ 종료
```

---

## 시퀀스 다이어그램 vs 상태 다이어그램

| 구분 | 시퀀스 다이어그램 | 상태 다이어그램 |
|------|-----------------|-----------------|
| **표현** | 객체들의 상호작용 | 객체의 상태 변화 |
| **시간** | 시간 순서 중요 | 상태 변화 중심 |
| **코드** | 메서드 호출 순서 | switch-case 문 |
| **사용** | 프로세스 흐름 | 상태 관리 |

---

## 실제 예제

### 신용카드 결제 시스템

#### 시퀀스 다이어그램

```
User → PaymentSystem → BankAPI → Card
  │         │            │        │
  ├────pay──→│            │        │
  │         ├─validate────→│        │
  │         │              ├─check─→│
  │         │<─approved────┤        │
  │         │<─confirmed───┤        │
  │←─success─┤            │        │
```

#### 상태 다이어그램

```
대기 ──(결제 시작)--> 인증 중 
│                    │
└────(취소)---------┘
                    │
                (인증 성공)
                    │
                    ↓
                결제 완료
```

---

## 정리

### 시퀀스 다이어그램

```
목적: 여러 객체가 어떻게 협력하는가를 보여줌
코드: 메서드가 순서대로 호출되는 방식으로 구현
```

### 상태 다이어그램

```
목적: 객체가 어떤 상태를 거쳐 변화하는가를 보여줌
코드: switch-case 문으로 상태에 따라 다르게 처리
```

### 프로그래밍 관점

```
시퀀스 다이어그램 → 메서드 호출 순서
상태 다이어그램 → 상태 변수와 조건문
```